<!DOCTYPE html>
<html>
<head>
	<title>Shopee Link Converter</title>
</head>
<body>
	<h2>Shopee Link Converter</h2>
	<form>
		<!-- <label for="link">Shopee Link:</label><br> -->
		<input type="text" id="link" placeholder="Paste URL" style="width: 50%">
		<input type="button" value="Convert" onclick="convert()">
		<input type="button" value="Clear" onclick="clearInput()">
	</form>
	<p id="result"></p>

	<script>
		function clearInput() {
			document.getElementById("result").innerHTML = "";
			document.getElementById("link").value = "";
		}
		
		function convert() {
			var text = document.getElementById("link").value;
			if (text !== "") {
				var a = charPos(text, "/");
				if (a.length > 0 && text.search("http")>-1 && text.search("shopee")>-1) {
					var a1 = text.substring(0, a[2]+1);
					if (a1 !== "") {
						a1 = a1+"product/";
					}
					var b = text.split("-i.").pop();
					if (b.includes("?")) {
						var c = b.slice(0, b.lastIndexOf("?"));
					} else {
						var c = b;
					}
					c = c.replace(".", "/");
					var url = a1+c;
				  
					document.getElementById("result").innerHTML = "<a href="+url+"  target=\"_blank\"><span id=\"url\">"+url+"</span></a> &nbsp; <button onclick=\"copy()\">Copy text</button>";
					document.getElementById("link").value = "";
				} else {
					document.getElementById("result").innerHTML = "";
					document.getElementById("link").value = "";
				}
			}
		}

		function charPos(str, char) {
			return str
				.split("")
				.map(function (c, i) { if (c == char) return i; })
				.filter(function (v) { return v >= 0; });
		}
		
		function copy() {
			let text = document.getElementById("url").innerText;
			navigator.clipboard.writeText(text);
			console.log('Content copied to clipboard');
			// document.getElementById("result").innerHTML = "";
		}
	</script>
</body>
</html>
